<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="web前端开发, 前端开发工程师, 前端开发攻城师, 前端资源, CSS, JavaScript, HTML, Web标准"><meta name="theme-color" content="#db5945"><title>微信点歌模块代码更新及hexo音乐插件 | 逢十借一</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">微信点歌模块代码更新及hexo音乐插件</h1><a id="logo" href="/.">逢十借一</a><p class="description">和自己赛跑的人</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">微信点歌模块代码更新及hexo音乐插件</h1><div class="post-meta">Oct 31, 2016<span> | </span><span class="category"><a href="/categories/总结/">总结</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2016/10/31/wechat-music-serach-module-update/" href="/2016/10/31/wechat-music-serach-module-update/#comments" class="ds-thread-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-搜索模块重写"><span class="toc-number">1.</span> <span class="toc-text">[1] 搜索模块重写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-hexo音乐插件"><span class="toc-number">2.</span> <span class="toc-text">[2] hexo音乐插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-小结"><span class="toc-number">3.</span> <span class="toc-text">[3] 小结:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-数据转换"><span class="toc-number">3.1.</span> <span class="toc-text">[1] 数据转换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-node中的同步请求"><span class="toc-number">3.2.</span> <span class="toc-text">[2] node中的同步请求</span></a></li></ol></li></ol></div></div><div class="post-content"><script src="/assets/js/APlayer.min.js"> </script><h3 id="1-搜索模块重写"><a href="#1-搜索模块重写" class="headerlink" title="[1] 搜索模块重写"></a>[1] 搜索模块重写</h3><p>由于云音乐那边接口的变动原本的音乐搜索功能没法使用了，于是就重写了一下。主要是关键词搜索的函数，其间发现其搜索的逻辑也发生了变化，所以相应的关键词分析匹配的地方也得重写。</p>
<p>核心的关键词搜索函数music_search<br><figure class="highlight php"><table><tr><td class="code"><pre><div class="line"><span class="comment">// @param</span></div><div class="line"><span class="comment">// s:搜索关键词</span></div><div class="line"><span class="comment">// type: 类型(1:歌曲,100歌手)</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">music_search</span><span class="params">($s,$type=<span class="number">1</span>)</span></span></div><div class="line">&#123;</div><div class="line">    $type||$type=<span class="number">1</span>;</div><div class="line">    $url= <span class="string">"http://music.163.com/api/search/get/web?csrf_token="</span>;</div><div class="line">    $curl = curl_init();</div><div class="line">    $post_data = <span class="string">'hlpretag=&amp;hlposttag=&amp;s='</span>. $s . <span class="string">'&amp;type='</span>.$type.<span class="string">'&amp;offset=0&amp;total=true&amp;limit=1'</span>;</div><div class="line">    curl_setopt($curl, CURLOPT_URL,$url);</div><div class="line">    curl_setopt($curl, CURLOPT_RETURNTRANSFER,<span class="number">1</span>);</div><div class="line">    $header =<span class="keyword">array</span>(</div><div class="line">        <span class="string">'Host: music.163.com'</span>,</div><div class="line">        <span class="string">'Origin: http://music.163.com'</span>,</div><div class="line">        <span class="string">'User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.90 Safari/537.36'</span>,</div><div class="line">        <span class="string">'Content-Type: application/x-www-form-urlencoded'</span>,</div><div class="line">        <span class="string">'Referer: http://music.163.com/search/'</span>,</div><div class="line">    );</div><div class="line">    curl_setopt($curl, CURLOPT_HTTPHEADER, $header);</div><div class="line">    curl_setopt($curl, CURLOPT_POST, <span class="number">1</span>);</div><div class="line">    curl_setopt($curl, CURLOPT_POSTFIELDS, $post_data);</div><div class="line">    $src = curl_exec($curl);</div><div class="line">    curl_close($curl);</div><div class="line">    <span class="keyword">return</span> $src;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>获取微信中需要数据函数getWechatFormatData(核心代码)<br><figure class="highlight php"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getWechatFormatData</span><span class="params">($word)</span></span></div><div class="line">&#123;</div><div class="line">    $result = json_decode(music_search($word), <span class="keyword">true</span>); <span class="comment">// 默认按歌曲先搜索一次（true转换为数组）</span></div><div class="line"></div><div class="line">    $is_Song = <span class="keyword">false</span>;   <span class="comment">// 搜索关键词是否为歌曲</span></div><div class="line">    $isEnglish = preg_match(<span class="string">"/^[a-zA-Z\s]+$/"</span>,$word);   <span class="comment">// 是否为英文歌/歌手</span></div><div class="line">    $arr = preg_split(<span class="string">"/[\s,]+/"</span>, $word);</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(!$isEnglish) &#123;</div><div class="line">        <span class="keyword">if</span>(count($arr) == <span class="number">1</span>) &#123; <span class="comment">// 非英文且只有一个搜索关键词</span></div><div class="line">        $is_Song = $result[<span class="string">'result'</span>][<span class="string">'songs'</span>][<span class="number">0</span>][<span class="string">'name'</span>] == $word; <span class="comment">// 如果返回的歌曲名与搜索关键词相同即表示关键词为歌曲</span></div><div class="line">        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 非英文且多个关键词</span></div><div class="line">        <span class="keyword">foreach</span> ($arr <span class="keyword">as</span> $key =&gt; $keyword) &#123;</div><div class="line">            $result = json_decode(music_search($keyword) ,<span class="keyword">true</span>);</div><div class="line">            <span class="keyword">if</span>($result[<span class="string">'result'</span>][<span class="string">'songs'</span>][<span class="number">0</span>][<span class="string">'name'</span>] == $keyword) &#123;</div><div class="line">                $is_Song = <span class="keyword">true</span>;    <span class="comment">//  如果搜索结果中的歌曲名与关键词中的某字段匹配则该字段为歌曲名</span></div><div class="line">                $result = json_decode(music_search($arr[$key]) , <span class="keyword">true</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;    <span class="comment">//  全英文</span></div><div class="line">        $is_Song = stristr($word,$result[<span class="string">'result'</span>][<span class="string">'songs'</span>][<span class="number">0</span>][<span class="string">'name'</span>]); <span class="comment">// 如果搜索结果中的歌曲名中有某个字段则按歌曲搜索，否则按歌手搜索</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> ($is_Song) &#123;</div><div class="line">        <span class="comment">// do operation</span></div><div class="line">        <span class="keyword">return</span> $info;</div><div class="line">    &#125;</div><div class="line">     <span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// do operation</span></div><div class="line">        <span class="keyword">return</span> $info;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="2-hexo音乐插件"><a href="#2-hexo音乐插件" class="headerlink" title="[2] hexo音乐插件"></a>[2] hexo音乐插件</h3><p>前两天在微博上看到胡子歌在barretlee.com上做了一个歌单展示页，上面竟然李志，不行我也得整一个。看他说UI是用了一款开源的播放器<a href="https://github.com/DIYgod/APlayer" target="_blank" rel="external">APlayer</a>,于是简单看了下，巧的是已经有人写过一个基于APlayer的hexo插件 - <a href="https://github.com/grzhan/hexo-tag-aplayer" target="_blank" rel="external">hexo-tag-aplayer</a>。不过看了只能添加单曲，添加不了专辑或是歌单。正好刚重写了搜索的API，感觉可以搞一搞。</p>
<p>插件用的是利用了Hexo可以自定义标签插件自定义了歌单标签。<br><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line">hexo.extend.tag.register(<span class="string">'aplayerlist'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">args</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> albumlist_id = args[<span class="number">0</span>], narrow = <span class="literal">false</span>, autoplay = <span class="literal">false</span>, width = <span class="string">''</span>,</div><div class="line">        id = <span class="string">'aplayer'</span> + (counter++), raw = <span class="string">''</span>, content = <span class="string">''</span>;</div><div class="line">    <span class="comment">// Parse optional arguments</span></div><div class="line">    <span class="keyword">if</span> (args.length &gt; <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">var</span> options = args.slice(<span class="number">1</span>);</div><div class="line">        narrow = options.indexOf(<span class="string">'narrow'</span>) &lt; <span class="number">0</span> ? <span class="literal">false</span> : <span class="literal">true</span>;</div><div class="line">        autoplay = options.indexOf(<span class="string">'autoplay'</span>) &lt; <span class="number">0</span> ? <span class="literal">false</span> : <span class="literal">true</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; options.length; i++) &#123;</div><div class="line">            <span class="keyword">var</span> option = options[i];</div><div class="line">            width = option.indexOf(<span class="string">'width:'</span>) == <span class="number">0</span> ? option + <span class="string">';'</span> : width;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    width = narrow ? <span class="string">''</span> : width;</div><div class="line">    <span class="keyword">var</span> album;</div><div class="line">    <span class="keyword">var</span> req = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">        req.open(<span class="string">'GET'</span>, <span class="string">"***/hexo_playlist.php?id="</span> + albumlist_id, <span class="literal">false</span>);</div><div class="line">        req.send();</div><div class="line">        <span class="keyword">if</span>(req.status === <span class="number">200</span>) &#123;</div><div class="line">            album = req.responseText;</div><div class="line">        &#125;</div><div class="line">        raw = <span class="string">'&lt;div id="'</span>+ id + <span class="string">'" class="aplayer" style="margin-bottom: 20px;display:inline-block;'</span>+ width + <span class="string">'"&gt;'</span>;</div><div class="line">        raw +=</div><div class="line">        <span class="string">'&lt;/div&gt;&lt;script&gt;var '</span>+ id + <span class="string">' = new APlayer(&#123;'</span>+</div><div class="line">                <span class="string">'element: document.getElementById("'</span>+ id +<span class="string">'"),'</span> +</div><div class="line">                <span class="string">'narrow: '</span> + (narrow ? <span class="string">'true'</span> : <span class="string">'false'</span>) + <span class="string">','</span> +</div><div class="line">                <span class="string">'autoplay: '</span> + (autoplay ? <span class="string">'true'</span> : <span class="string">'false'</span>) + <span class="string">','</span> +</div><div class="line">                <span class="string">'music : '</span> + album +</div><div class="line">            <span class="string">'&#125;);'</span> +</div><div class="line">        id + <span class="string">'.init();&lt;/script&gt;'</span>;</div><div class="line">    <span class="keyword">return</span> raw;</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>然后在md文件中以<code><div id="aplayer0" class="aplayer" style="margin-bottom: 20px;display:inline-block;"></div><script>var aplayer0 = new APlayer({element: document.getElementById("aplayer0"),narrow: false,autoplay: false,music : 
Notice: Undefined index: album in /data/home/qxu1098560294/htdocs/wechat/hexo_api.php on line 66

Warning: Invalid argument supplied for foreach() in /data/home/qxu1098560294/htdocs/wechat/hexo_api.php on line 68
[]});aplayer0.init();</script></code>的格式即可调用。<br>其中只有<code>album_id</code>这个参数是必须的，传入的是专辑的id，当然也可以传歌单id，只要在实现里面调歌单搜索的API即可。后面的参数都是可选的。</p>
<ul>
<li><code>narrow</code>是否显示歌曲列表，默认隐藏</li>
<li><code>autoplay</code> 是否自动播放<br>除此之外还可以配置大小，不过这个地方我直接设了固定的宽度。</li>
</ul>
<p>插件原本一个标签只能放一首歌，于是也重写了下<br><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line">&#123;% aplayer [&#123;&#125;,&#123;&#125;]  [narrow, autoplay] %&#125;</div></pre></td></tr></table></figure></p>
<p>以数组的形式传入包含每首歌的信息的对象即可，代码如下:<br><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line">hexo.extend.tag.register(<span class="string">'aplayer'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">args</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> narrow = <span class="literal">false</span>, autoplay = <span class="literal">false</span>, width = <span class="string">''</span>,</div><div class="line">        id = <span class="string">'aplayer'</span> + (counter++), raw = <span class="string">''</span>, content = <span class="string">''</span>;</div><div class="line">    <span class="keyword">if</span> (args.length &gt; <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">var</span> options = args.slice(<span class="number">1</span>);</div><div class="line">        narrow = options.indexOf(<span class="string">'narrow'</span>) &lt; <span class="number">0</span> ? <span class="literal">false</span> : <span class="literal">true</span>;</div><div class="line">        autoplay = options.indexOf(<span class="string">'autoplay'</span>) &lt; <span class="number">0</span> ? <span class="literal">false</span> : <span class="literal">true</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; options.length; i++) &#123;</div><div class="line">            <span class="keyword">var</span> option = options[i];</div><div class="line">            width = option.indexOf(<span class="string">'width:'</span>) == <span class="number">0</span> ? option + <span class="string">';'</span> : width;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    width = narrow ? <span class="string">''</span> : width;</div><div class="line">    <span class="keyword">var</span> album = [];</div><div class="line">    <span class="keyword">var</span> data = <span class="built_in">eval</span>(args[<span class="number">0</span>]);</div><div class="line">    data.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">song</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> song_info = &#123;</div><div class="line">            <span class="attr">title</span>: song[<span class="number">0</span>],</div><div class="line">            <span class="attr">author</span>: song[<span class="number">1</span>],</div><div class="line">            <span class="attr">url</span>: song[<span class="number">2</span>],</div><div class="line">            <span class="attr">pic</span>: song[<span class="number">3</span>]</div><div class="line">        &#125;;</div><div class="line">    album.push(song_info);</div><div class="line">    &#125;);</div><div class="line">    raw = <span class="string">'&lt;div id="'</span>+ id + <span class="string">'" class="aplayer" style="margin-bottom: 20px;'</span>+ width + <span class="string">'"&gt;'</span>;</div><div class="line">    raw +=</div><div class="line">        <span class="string">'&lt;/div&gt;&lt;script&gt;var '</span>+ id + <span class="string">' = new APlayer(&#123;'</span>+</div><div class="line">                <span class="string">'element: document.getElementById("'</span>+ id +<span class="string">'"),'</span> +</div><div class="line">                <span class="string">'narrow: '</span> + (narrow ? <span class="string">'true'</span> : <span class="string">'false'</span>) + <span class="string">','</span> +</div><div class="line">                <span class="string">'autoplay: '</span> + (autoplay ? <span class="string">'true'</span> : <span class="string">'false'</span>) + <span class="string">','</span> +</div><div class="line">                <span class="string">'music : '</span> + <span class="built_in">JSON</span>.stringify(album) +</div><div class="line">            <span class="string">'&#125;);'</span> +</div><div class="line">        id + <span class="string">'.init();&lt;/script&gt;'</span>;</div><div class="line">    <span class="keyword">return</span> raw;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h3 id="3-小结"><a href="#3-小结" class="headerlink" title="[3] 小结:"></a>[3] 小结:</h3><p>插件本身没什么技术含量，利用了之前写好的搜索接口，获取到数据后按照APlayer的格式生成APlayer对象即可。但还是出现了两个很蛋疼的事情：一个是从接口获取到数据后的转换，一个是node中的同步ajax。</p>
<h4 id="1-数据转换"><a href="#1-数据转换" class="headerlink" title="[1] 数据转换"></a>[1] 数据转换</h4><p>APlayer音乐信息部分的数据是这样的<code>[{title:, url:,xxx:...},{title:, url:,xxx:...}]</code>。但是php如果直接传数组过来根本没法用，因为php中的数组是这样的格式:<br><figure class="highlight php"><table><tr><td class="code"><pre><div class="line"><span class="keyword">array</span>(</div><div class="line">    [<span class="number">0</span>] =&gt; &#123;&#125;,</div><div class="line">    [<span class="number">1</span>] =&gt; &#123;&#125;</div><div class="line">    )</div></pre></td></tr></table></figure></p>
<p>这样的传过来根本没法解析(应该是解析起来麻烦)。json格式也试了，序列化的时候还是带php数组的那一坨。思来想去还是字符串靠谱，虽然拼字符串很烦，仿佛又回到了后端模板的时代，不过确实很管用。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">batch_get_song_info</span><span class="params">($album_id)</span></span></div><div class="line">&#123;</div><div class="line">    $result = json_decode(get_album_info($album_id), <span class="keyword">true</span>);</div><div class="line">    $result = $result[<span class="string">"album"</span>][<span class="string">"songs"</span>];</div><div class="line">    $song_list = <span class="string">"["</span>;</div><div class="line">    <span class="keyword">foreach</span> ($result <span class="keyword">as</span> $key =&gt; $song) &#123;</div><div class="line">        $result = json_decode(get_music_info($song[<span class="string">'id'</span>]), <span class="keyword">true</span>);</div><div class="line"></div><div class="line">        $result = $result[<span class="string">'songs'</span>][<span class="number">0</span>];</div><div class="line">        $info = <span class="string">"&#123;"</span>;</div><div class="line">        $music_name = $result[<span class="string">'name'</span>];</div><div class="line">        $artist_name = $result[<span class="string">'artists'</span>][<span class="number">0</span>][<span class="string">'name'</span>];</div><div class="line">        $music_url = $result[<span class="string">'mp3Url'</span>];</div><div class="line">        $music_pic = $result[<span class="string">'album'</span>][<span class="string">'picUrl'</span>];</div><div class="line">        $info .= <span class="string">"title:'"</span> .$music_name . <span class="string">"',author:'"</span> . $artist_name . <span class="string">"',url:'"</span> .$music_url . <span class="string">"',pic:'"</span> . $music_pic . <span class="string">"'&#125;,"</span>;</div><div class="line">        $song_list .= $info;</div><div class="line">    &#125;</div><div class="line">     $song_list = rtrim($song_list,<span class="string">","</span>);</div><div class="line">     $song_list .= <span class="string">"]"</span>;</div><div class="line">     <span class="keyword">return</span> $song_list;</div><div class="line">&#125;</div><div class="line"><span class="comment">// example</span></div><div class="line">$album_id = $_GET[<span class="string">'id'</span>];</div><div class="line">$result = get_album_detail($album_id);</div><div class="line">print_r($result);</div></pre></td></tr></table></figure>
<p>出入专辑id之后get_album_info获取专辑内所有歌曲的id(不得不佩服老东家，云音乐的大部分API都无法一次得到你想要的所有数据,当时MV和歌单那块还是我写的呢，唉…)，然后用get_music_info挨个搜一遍，最后就是蛋疼的拼字符串。</p>
<h4 id="2-node中的同步请求"><a href="#2-node中的同步请求" class="headerlink" title="[2] node中的同步请求"></a>[2] node中的同步请求</h4><p>一开始想用高大上的fetch，但是fetch好像没法同步请求，试了一大推其他的模块，最后还是回到了我熟悉的xhr<br><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="comment">// xmlhttprequest node中的XHR模块</span></div><div class="line">    XMLHttpRequest = <span class="built_in">require</span>(<span class="string">"xmlhttprequest"</span>).XMLHttpRequest;</div><div class="line">    <span class="keyword">var</span> album, req = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">        req.open(<span class="string">'GET'</span>, <span class="string">"http://bgm.iminyao.com/wechat/hexo_playlist.php?id="</span> + albumlist_id, <span class="literal">false</span>);</div><div class="line">        req.send();</div><div class="line">        <span class="keyword">if</span>(req.status === <span class="number">200</span>) &#123;</div><div class="line">            album = req.responseText;</div><div class="line">        &#125;</div></pre></td></tr></table></figure></p>
<p>熟悉的感觉，还是原来味道。</p>
<p>这还不是关键，关键是发现自己对请求这块还不是很熟悉，包括XMLHttpRequest，更别说fetch了，特别是数据类型这一块，回头得好好总结一下。</p>
<p>还有一个大彩蛋，写完了往博客上添专辑的时候才想起来，虾米垄断了滚石的版权，小李的音乐包括《理性与感性作品音乐会》基本上都跪了。最蛋疼的是通过API还能搜到音乐资源，但是资源已经失效…专辑搜索的接口就是这么玩的，数据里面有MP3链接，但是全部是404…这个问题待解决。</p>
<p>有钱真好，马云爸爸，请收下我的膝盖😭</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://vino24.cn/2016/10/31/wechat-music-serach-module-update/" data-id="cixa9popn008oearn2pgiwjsb" class="article-share-link">分享到</a><div class="tags"></div><div class="post-nav"><a href="/2016/11/01/hexo-basic/" class="pre">hexo常用配置一览</a><a href="/2016/10/27/three.js-first/" class="next">three.js入门</a></div><div data-thread-key="2016/10/31/wechat-music-serach-module-update/" data-title="微信点歌模块代码更新及hexo音乐插件" data-url="http://vino24.cn/2016/10/31/wechat-music-serach-module-update/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2016/10/31/wechat-music-serach-module-update/" data-title="微信点歌模块代码更新及hexo音乐插件" data-url="http://vino24.cn/2016/10/31/wechat-music-serach-module-update/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CSS/">CSS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTTP/">HTTP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/IE/">IE</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript-API/">JavaScript API</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript-Framework/">JavaScript Framework</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mobile-Develop/">Mobile Develop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Performance-Optimize/">Performance Optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Requirements-Daily/">Requirements&&Daily</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/devTools-Configuration/">devTools&&Configuration</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/切图/">切图</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/总结/">总结</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Ajax/" style="font-size: 15px;">Ajax</a> <a href="/tags/CSS-Layout/" style="font-size: 15px;">CSS Layout</a> <a href="/tags/CSS-Core/" style="font-size: 15px;">CSS Core</a> <a href="/tags/CSS-Collection/" style="font-size: 15px;">CSS Collection</a> <a href="/tags/DOM/" style="font-size: 15px;">DOM</a> <a href="/tags/CSS-core/" style="font-size: 15px;">CSS core</a> <a href="/tags/ES6/" style="font-size: 15px;">ES6</a> <a href="/tags/JavaScript-Core/" style="font-size: 15px;">JavaScript Core</a> <a href="/tags/bind/" style="font-size: 15px;">bind</a> <a href="/tags/PS/" style="font-size: 15px;">PS</a> <a href="/tags/性能优化/" style="font-size: 15px;">性能优化</a> <a href="/tags/avalon-js/" style="font-size: 15px;">avalon.js</a> <a href="/tags/JavaScript-API/" style="font-size: 15px;">JavaScript API</a> <a href="/tags/Flex/" style="font-size: 15px;">Flex</a> <a href="/tags/内存泄漏/" style="font-size: 15px;">内存泄漏</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/Mac/" style="font-size: 15px;">Mac</a> <a href="/tags/Netease-Weekly/" style="font-size: 15px;">Netease Weekly</a> <a href="/tags/react-js/" style="font-size: 15px;">react.js</a> <a href="/tags/React/" style="font-size: 15px;">React</a> <a href="/tags/this/" style="font-size: 15px;">this</a> <a href="/tags/three-js/" style="font-size: 15px;">three.js</a> <a href="/tags/Vue/" style="font-size: 15px;">Vue</a> <a href="/tags/Tips/" style="font-size: 15px;">Tips</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/12/08/es6-spread-rest/">ES6 spread和rest operator</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/08/react-form/">react中的表单</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/06/github-tip/">github实用技巧</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/02/react-first/">react.js入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/28/avalon-first-md/">avalon.js入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/22/chrome-dev-tools-console/">Chrome Dev Tools使用技巧总结(一) Console</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/02/fetch-api/">Fetch API</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/01/hexo-basic/">hexo常用配置一览</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/31/wechat-music-serach-module-update/">微信点歌模块代码更新及hexo音乐插件</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/27/three.js-first/">three.js入门</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> 最近评论</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://bgm.iminyao.com/" title="背景音乐" target="_blank">背景音乐</a><ul></ul><a href="http://weibo.com/jzwmxz" title="民谣之家" target="_blank">民谣之家</a><ul></ul><a href="http://www.zhihu.com/people/iminyao" title="逢十借一" target="_blank">逢十借一</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">逢十借一.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"></a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'vino24'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>