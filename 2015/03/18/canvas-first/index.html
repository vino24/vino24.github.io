<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="web前端开发, 前端开发工程师, 前端开发攻城师, 前端资源, CSS, JavaScript, HTML, Web标准"><meta name="theme-color" content="#db5945"><title>Canvas入门 | 逢十借一</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Canvas入门</h1><a id="logo" href="/.">逢十借一</a><p class="description">和自己赛跑的人</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Canvas入门</h1><div class="post-meta">Mar 18, 2015<span> | </span><span class="category"><a href="/categories/JavaScript/">JavaScript</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2015/03/18/canvas-first/" href="/2015/03/18/canvas-first/#comments" class="ds-thread-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#基础知识"><span class="toc-number">1.</span> <span class="toc-text">基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#页面基本结构"><span class="toc-number">1.1.</span> <span class="toc-text">页面基本结构:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#绘制直线"><span class="toc-number">1.2.</span> <span class="toc-text">绘制直线</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#绘制三角形并填充颜色"><span class="toc-number">1.3.</span> <span class="toc-text">绘制三角形并填充颜色</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#绘制并填充长方形-直接使用fillRect-和strokeRect-函数"><span class="toc-number">1.4.</span> <span class="toc-text">绘制并填充长方形(直接使用fillRect()和strokeRect()函数)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#绘制圆-弧"><span class="toc-number">1.5.</span> <span class="toc-text">绘制圆(弧)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#绘制椭圆"><span class="toc-number">1.6.</span> <span class="toc-text">绘制椭圆</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#变换——translate-平移-scale-缩放-rotate-旋转-matrix-矩阵"><span class="toc-number">1.7.</span> <span class="toc-text">变换——translate(平移) scale(缩放) rotate(旋转) matrix(矩阵)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#透明度-globalCompositeOperation属性设置如何处理图形重叠部分"><span class="toc-number">1.8.</span> <span class="toc-text">透明度(globalCompositeOperation属性设置如何处理图形重叠部分)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基于Canvas的画图程序"><span class="toc-number">2.</span> <span class="toc-text">基于Canvas的画图程序</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#paint-html"><span class="toc-number">2.0.1.</span> <span class="toc-text">paint.html</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#function-js"><span class="toc-number">2.0.2.</span> <span class="toc-text">function.js</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#style-css"><span class="toc-number">2.0.3.</span> <span class="toc-text">style.css</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#高级Canvas绘图"><span class="toc-number">3.</span> <span class="toc-text">高级Canvas绘图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#绘制图像"><span class="toc-number">3.1.</span> <span class="toc-text">绘制图像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#裁剪、切割、伸缩图片"><span class="toc-number">3.2.</span> <span class="toc-text">裁剪、切割、伸缩图片</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#绘制视频帧"><span class="toc-number">3.3.</span> <span class="toc-text">绘制视频帧</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#绘制文本"><span class="toc-number">3.4.</span> <span class="toc-text">绘制文本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#添加阴影"><span class="toc-number">3.5.</span> <span class="toc-text">添加阴影</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#填充图案"><span class="toc-number">3.6.</span> <span class="toc-text">填充图案</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#填充渐变"><span class="toc-number">3.7.</span> <span class="toc-text">填充渐变</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#绘制图解"><span class="toc-number">3.8.</span> <span class="toc-text">绘制图解</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#canvas图形交互"><span class="toc-number">4.</span> <span class="toc-text">canvas图形交互</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#InteractiveCircles-html"><span class="toc-number">4.1.</span> <span class="toc-text">InteractiveCircles.html</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#InteractiveCircles-js"><span class="toc-number">4.2.</span> <span class="toc-text">InteractiveCircles.js</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#canvas动画"><span class="toc-number"></span> <span class="toc-text">canvas动画</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#基本动画-方形下落"><span class="toc-number">0.1.</span> <span class="toc-text">基本动画(方形下落)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#多物体动画-模拟小球自由下落"><span class="toc-number">0.2.</span> <span class="toc-text">多物体动画(模拟小球自由下落)</span></a></li></ol></li></ol></div></div><div class="post-content"><script src="/assets/js/APlayer.min.js"> </script><h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><h4 id="页面基本结构"><a href="#页面基本结构" class="headerlink" title="页面基本结构:"></a>页面基本结构:</h4><figure class="highlight xml"><table><tr><td class="code"><pre><div class="line">css:</div><div class="line">canvas&#123;</div><div class="line">			border: 1px dashed black;</div><div class="line">		&#125;</div><div class="line">html</div><div class="line">        <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"drawingCanvas"</span> <span class="attr">width</span>=<span class="string">"500"</span> <span class="attr">height</span>=<span class="string">"300"</span>&gt;</span> <span class="comment">&lt;!--width height必须在此处设置--&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">js:在页面加载是取得Canvas绘图上下文，以下所有绘图代码均添加在此函数</div><div class="line">window.onload=function()&#123;</div><div class="line">			var canvas=document.getElementById("drawingCanvas");</div><div class="line">			var context=canvas.getContext("2d"); //	取得二维绘图上下文</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="绘制直线"><a href="#绘制直线" class="headerlink" title="绘制直线"></a>绘制直线</h4><figure class="highlight verilog"><table><tr><td class="code"><pre><div class="line">                     <span class="comment">/* </span></div><div class="line">                      *线条样式设置 </div><div class="line">                     */</div><div class="line">                     <span class="keyword">context</span><span class="variable">.lineWidth</span>=<span class="number">10</span>; 			                <span class="comment">//设置线条宽度</span></div><div class="line"><span class="keyword">context</span><span class="variable">.strokeStyle</span>=<span class="string">"rgb(205,40,40)"</span>; 		<span class="comment">//设置线条颜色</span></div><div class="line"></div><div class="line"><span class="keyword">context</span><span class="variable">.moveTo</span>(<span class="number">10</span>,<span class="number">50</span>); 			<span class="comment">//找到直线的起点</span></div><div class="line"><span class="keyword">context</span><span class="variable">.lineTo</span>(<span class="number">400</span>,<span class="number">50</span>);			<span class="comment">//在起点和终点之间建立联系</span></div><div class="line"><span class="keyword">context</span><span class="variable">.lineCap</span>=<span class="string">"butt"</span>;			<span class="comment">//设置线条两端的形状 butt为默认</span></div><div class="line"><span class="keyword">context</span><span class="variable">.stroke</span>();				<span class="comment">//实际的绘制直线,lineTo()负责画直线，调用     </span></div><div class="line">                                                                             <span class="comment">//stroke()才会显示直线</span></div><div class="line"></div><div class="line"><span class="keyword">context</span><span class="variable">.beginPath</span>();			<span class="comment">//调用beginPath()重新开始新线段绘制</span></div><div class="line"><span class="keyword">context</span><span class="variable">.moveTo</span>(<span class="number">10</span>,<span class="number">120</span>);</div><div class="line"><span class="keyword">context</span><span class="variable">.lineTo</span>(<span class="number">400</span>,<span class="number">120</span>);</div><div class="line"><span class="keyword">context</span><span class="variable">.lineCap</span>=<span class="string">"round"</span>;                <span class="comment">//圆头</span></div><div class="line"><span class="keyword">context</span><span class="variable">.stroke</span>();</div><div class="line"></div><div class="line"><span class="keyword">context</span><span class="variable">.beginPath</span>();</div><div class="line"><span class="keyword">context</span><span class="variable">.moveTo</span>(<span class="number">10</span>,<span class="number">190</span>);</div><div class="line"><span class="keyword">context</span><span class="variable">.lineTo</span>(<span class="number">400</span>,<span class="number">190</span>);</div><div class="line"><span class="keyword">context</span><span class="variable">.lineCap</span>=<span class="string">"square"</span>; 	      <span class="comment">//加长方头</span></div><div class="line"><span class="keyword">context</span><span class="variable">.stroke</span>();</div></pre></td></tr></table></figure>
<h4 id="绘制三角形并填充颜色"><a href="#绘制三角形并填充颜色" class="headerlink" title="绘制三角形并填充颜色"></a>绘制三角形并填充颜色</h4><figure class="highlight verilog"><table><tr><td class="code"><pre><div class="line"><span class="keyword">context</span><span class="variable">.lineWidth</span>=<span class="number">10</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.strokeStyle</span>=<span class="string">"red"</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.lineJoin</span>=<span class="string">"bevel"</span>;	                <span class="comment">//可以通过lineJoin属性设置交点的形状 默认</span></div><div class="line">                                                                             <span class="comment">// mitre(锐角斜接) round(圆头) bevel(平头斜接)</span></div><div class="line"><span class="keyword">context</span><span class="variable">.fillStyle</span>=<span class="string">"blue"</span>;	               <span class="comment">//先填充内部，后绘制轮廓，否则轮廓会被填充覆盖</span></div><div class="line"></div><div class="line">                     <span class="keyword">context</span><span class="variable">.moveTo</span>(<span class="number">250</span>,<span class="number">50</span>);</div><div class="line">                     <span class="keyword">context</span><span class="variable">.lineTo</span>(<span class="number">50</span>,<span class="number">250</span>);</div><div class="line"><span class="keyword">context</span><span class="variable">.lineTo</span>(<span class="number">450</span>,<span class="number">250</span>);</div><div class="line"><span class="keyword">context</span><span class="variable">.lineTo</span>(<span class="number">250</span>,<span class="number">50</span>);		<span class="comment">//可省略 closePath()会自动在最后一个绘制点绘制与起</span></div><div class="line">                                                                     <span class="comment">//点的连线</span></div><div class="line"><span class="keyword">context</span><span class="variable">.closePath</span>(); 		<span class="comment">//关闭路径</span></div><div class="line"></div><div class="line"><span class="keyword">context</span><span class="variable">.fill</span>();</div><div class="line"><span class="keyword">context</span><span class="variable">.stroke</span>();</div></pre></td></tr></table></figure>
<h4 id="绘制并填充长方形-直接使用fillRect-和strokeRect-函数"><a href="#绘制并填充长方形-直接使用fillRect-和strokeRect-函数" class="headerlink" title="绘制并填充长方形(直接使用fillRect()和strokeRect()函数)"></a>绘制并填充长方形(直接使用<code>fillRect()</code>和<code>strokeRect()</code>函数)</h4><figure class="highlight lsl"><table><tr><td class="code"><pre><div class="line">context.fillStyle=<span class="string">"blue"</span>;</div><div class="line">context.lineWidth=<span class="number">5</span>;</div><div class="line">context.strokeStyle=<span class="string">"red"</span>;</div><div class="line"></div><div class="line">context.fillRect(<span class="number">10</span>,<span class="number">10</span>,<span class="number">100</span>,<span class="number">200</span>);		<span class="comment">//在(10,10)点放置一个100*200像素的矩形</span></div><div class="line">context.strokeRect(<span class="number">10</span>,<span class="number">10</span>,<span class="number">100</span>,<span class="number">200</span>);	<span class="comment">//绘制矩形框</span></div></pre></td></tr></table></figure>
<h4 id="绘制圆-弧"><a href="#绘制圆-弧" class="headerlink" title="绘制圆(弧)"></a>绘制圆(弧)</h4><figure class="highlight verilog"><table><tr><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line">                      *创建变量，保存圆弧信息</div><div class="line">                     */   </div><div class="line"><span class="keyword">var</span> centerX=<span class="number">150</span>;</div><div class="line"><span class="keyword">var</span> centerY=<span class="number">300</span>;</div><div class="line"><span class="keyword">var</span> radius=<span class="number">100</span>;</div><div class="line">                     <span class="comment">//startinngAngle endingAngle分别设置为0和2*Math.PI即为圆</span></div><div class="line"><span class="keyword">var</span> startinngAngle=<span class="number">1</span><span class="variable">.25</span>*Math<span class="variable">.PI</span>;                      </div><div class="line"><span class="keyword">var</span> endingAngle=<span class="number">1</span><span class="variable">.75</span>*Math<span class="variable">.PI</span>;</div><div class="line"></div><div class="line"><span class="comment">//使用确定的信息绘制圆弧</span></div><div class="line"><span class="keyword">context</span><span class="variable">.arc</span>(centerX,centerY,radius,startinngAngle,endingAngle);</div><div class="line"><span class="keyword">context</span><span class="variable">.closePath</span>(); 			<span class="comment">//添加closePath会得到一个封闭的小半圆</span></div><div class="line"><span class="keyword">context</span><span class="variable">.stroke</span>();</div></pre></td></tr></table></figure>
<h4 id="绘制椭圆"><a href="#绘制椭圆" class="headerlink" title="绘制椭圆"></a>绘制椭圆</h4><figure class="highlight verilog"><table><tr><td class="code"><pre><div class="line"><span class="keyword">context</span><span class="variable">.moveTo</span>(<span class="number">62</span>,<span class="number">242</span>);</div><div class="line"></div><div class="line"><span class="comment">// 创建变量，保存两个控制点及曲线终点的信息</span></div><div class="line"><span class="keyword">var</span> control1_x=<span class="number">187</span>;</div><div class="line"><span class="keyword">var</span> control1_y=<span class="number">32</span>;</div><div class="line"><span class="keyword">var</span> control2_x=<span class="number">429</span>;</div><div class="line"><span class="keyword">var</span> control2_y=<span class="number">480</span>;</div><div class="line"><span class="keyword">var</span> endPointX=<span class="number">365</span>;</div><div class="line"><span class="keyword">var</span> endPointY=<span class="number">133</span>;</div><div class="line">                     <span class="comment">// 绘制曲线 bezierCurveTo() 贝塞尔曲线、 quadraticCurveTo() 二次曲线、 artTo()			  </span></div><div class="line">            <span class="keyword">context</span><span class="variable">.bezierCurveTo</span>(control1_x,control1_y,control2_x,control2_y,endPointX,endPointY);</div><div class="line"><span class="keyword">context</span><span class="variable">.closePath</span>();</div><div class="line"><span class="keyword">context</span><span class="variable">.stroke</span>();</div></pre></td></tr></table></figure>
<h4 id="变换——translate-平移-scale-缩放-rotate-旋转-matrix-矩阵"><a href="#变换——translate-平移-scale-缩放-rotate-旋转-matrix-矩阵" class="headerlink" title="变换——translate(平移) scale(缩放) rotate(旋转) matrix(矩阵)"></a>变换——translate(平移) scale(缩放) rotate(旋转) matrix(矩阵)</h4><figure class="highlight lsl"><table><tr><td class="code"><pre><div class="line">context.rect(<span class="number">0</span>,<span class="number">0</span>,<span class="number">30</span>,<span class="number">30</span>); 		<span class="comment">//在(0,0)点绘制正方形</span></div><div class="line"></div><div class="line">context.translate(<span class="number">50</span>,<span class="number">50</span>); 		<span class="comment">//把坐标系向下向右移动50像素 </span></div><div class="line">context.rect(<span class="number">0</span>,<span class="number">0</span>,<span class="number">30</span>,<span class="number">30</span>);</div><div class="line"></div><div class="line">context.translate(<span class="number">50</span>,<span class="number">50</span>);		<span class="comment">//把坐标系再向下向右移动50像素，(0,0)被平移到(100,100)</span></div><div class="line">                     context.rect(<span class="number">0</span>,<span class="number">0</span>,<span class="number">30</span>,<span class="number">30</span>);</div><div class="line">context.stroke();</div><div class="line"></div><div class="line">context.beginPath();</div><div class="line">context.translate(<span class="number">100</span>,<span class="number">100</span>);</div><div class="line"></div><div class="line"><span class="comment">//绘制9个正方形</span></div><div class="line">var copies=<span class="number">10</span>;</div><div class="line">for (var i = <span class="number">1</span>; i &lt;copies; i++) &#123;</div><div class="line">	context.rotate(<span class="number">2</span>*Math.<span class="literal">PI</span>*<span class="number">1</span>/(copies<span class="number">-1</span>));</div><div class="line">	context.rect(<span class="number">0</span>,<span class="number">0</span>,<span class="number">60</span>,<span class="number">60</span>);</div><div class="line">&#125;</div><div class="line">context.stroke();</div></pre></td></tr></table></figure>
<h4 id="透明度-globalCompositeOperation属性设置如何处理图形重叠部分"><a href="#透明度-globalCompositeOperation属性设置如何处理图形重叠部分" class="headerlink" title="透明度(globalCompositeOperation属性设置如何处理图形重叠部分)"></a>透明度(globalCompositeOperation属性设置如何处理图形重叠部分)</h4><figure class="highlight verilog"><table><tr><td class="code"><pre><div class="line"><span class="comment">//设置填充及描边颜色</span></div><div class="line"><span class="keyword">context</span><span class="variable">.fillStyle</span>=<span class="string">"rgb(100,150,185)"</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.lineWidth</span>=<span class="number">10</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.strokeStyle</span>=<span class="string">"red"</span>;</div><div class="line"></div><div class="line"><span class="comment">//绘制圆形</span></div><div class="line"><span class="keyword">context</span><span class="variable">.arc</span>(<span class="number">110</span>,<span class="number">120</span>,<span class="number">100</span>,<span class="number">0</span>,<span class="number">2</span>*Math<span class="variable">.PI</span>);</div><div class="line"><span class="keyword">context</span><span class="variable">.fill</span>();</div><div class="line"><span class="keyword">context</span><span class="variable">.stroke</span>();</div><div class="line"></div><div class="line"><span class="keyword">context</span><span class="variable">.beginPath</span>();                  <span class="comment">// 调用beginPath()再绘制新图形</span></div><div class="line"></div><div class="line"><span class="comment">//用半透明的颜色填充三角形</span></div><div class="line"><span class="keyword">context</span><span class="variable">.fillStyle</span>=<span class="string">"rgba(100,150,185,0.5)"</span>; </div><div class="line"><span class="comment">/** context.globalAlpha=0.5; context.fillStyle="rgba(100,150,185)"; 也能实现相同效果，globalAlpha包括描边颜色和填充颜色，且后续所有绘图操作都会使用此处设置的不透明度	 **/</span></div><div class="line"></div><div class="line"><span class="comment">//绘制三角形</span></div><div class="line"><span class="keyword">context</span><span class="variable">.moveTo</span>(<span class="number">215</span>,<span class="number">50</span>);</div><div class="line"><span class="keyword">context</span><span class="variable">.lineTo</span>(<span class="number">15</span>,<span class="number">250</span>);</div><div class="line"><span class="keyword">context</span><span class="variable">.lineTo</span>(<span class="number">315</span>,<span class="number">250</span>);</div><div class="line"><span class="keyword">context</span><span class="variable">.closePath</span>();</div><div class="line"><span class="keyword">context</span><span class="variable">.fill</span>();</div><div class="line"><span class="keyword">context</span><span class="variable">.stroke</span>();</div></pre></td></tr></table></figure>
<h3 id="基于Canvas的画图程序"><a href="#基于Canvas的画图程序" class="headerlink" title="基于Canvas的画图程序"></a>基于Canvas的画图程序</h3><h5 id="paint-html"><a href="#paint-html" class="headerlink" title="paint.html"></a>paint.html</h5><figure class="highlight xml"><table><tr><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>基于Canvas的画图程序<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"style.css"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"function.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	</div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"Toolbar"</span>&gt;</span></div><div class="line">			- Pen Color -<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"pen_red.gif"</span> <span class="attr">alt</span>=<span class="string">"Red Pen"</span> <span class="attr">onclick</span>=<span class="string">"changeColor('rgb(212,21,29)',this)"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"pen_green.gif"</span> <span class="attr">alt</span>=<span class="string">"Green Pen"</span> <span class="attr">onclick</span>=<span class="string">"changeColor('rgb(131,190,61)',this)"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"pen_blue.gif"</span> <span class="attr">alt</span>=<span class="string">"Blue Pen"</span> <span class="attr">onclick</span>=<span class="string">"changeColor('rgb(0,86,166)',this)"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"Toolbar"</span>&gt;</span></div><div class="line">			- Pen Thickness -<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"pen_thin.gif"</span> <span class="attr">alt</span>=<span class="string">"Thin Pen"</span> <span class="attr">onclick</span>=<span class="string">"changeThickness(1, this)"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"pen_medium.gif"</span> <span class="attr">alt</span>=<span class="string">"Medium Pen"</span> <span class="attr">onclick</span>=<span class="string">"changeThickness(5, this)"</span>&gt;</span> </div><div class="line">			<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"pen_thick.gif"</span> <span class="attr">alt</span>=<span class="string">"Thick Pen"</span> <span class="attr">onclick</span>=<span class="string">"changeThickness(10, this)"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">  		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"CanvasContainer"</span>&gt;</span></div><div class="line">    	                <span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"drawingCanvas"</span> <span class="attr">width</span>=<span class="string">"500"</span> <span class="attr">height</span>=<span class="string">"300"</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line">	        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">	     <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"Toolbar"</span>&gt;</span></div><div class="line">		- Operations -<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"saveCanvas()"</span>&gt;</span>Save the Canvas<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"clearCanvas()"</span>&gt;</span>Clear the Canvas<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">		        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"savedCopyContainer"</span>&gt;</span></div><div class="line">		             <span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">"savedImageCopy"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">		             Right-click to save ...</div><div class="line">		        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<h5 id="function-js"><a href="#function-js" class="headerlink" title="function.js"></a>function.js</h5><figure class="highlight qml"><table><tr><td class="code"><pre><div class="line"><span class="built_in">var</span> canvas;</div><div class="line"><span class="built_in">var</span> context;</div><div class="line"></div><div class="line"><span class="built_in">window</span>.onload=<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">       canvas=<span class="built_in">document</span>.getElementById(<span class="string">"drawingCanvas"</span>);</div><div class="line">       context=canvas.getContext(<span class="string">"2d"</span>);</div><div class="line">	</div><div class="line">	<span class="comment">//添加用于实现绘图操作的事件处理程序</span></div><div class="line">	canvas.onmousedown = startDrawing;</div><div class="line">	canvas.onmouseup   = stopDrawing;</div><div class="line">	canvas.onmouseout  = stopDrawing;</div><div class="line">	canvas.onmousemove = draw;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line"><span class="built_in">var</span> previousColorElement;                                  <span class="comment">//记录此前为选择颜色而被单击过&lt;img&gt;元素</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeColor</span>(<span class="params">color,imgElement</span>)</span>&#123;</div><div class="line">	</div><div class="line">	context.strokeStyle=<span class="built_in">color</span>;                             <span class="comment">//重新设置当前绘图要使用的颜色</span></div><div class="line">	</div><div class="line">	imgElement.className=<span class="string">"Selected"</span>;             <span class="comment">//为刚被单击过的&lt;img&gt;元素应用新样式</span></div><div class="line"></div><div class="line">	<span class="comment">//恢复上一次被单击&lt;img&gt;元素的样式</span></div><div class="line">	<span class="keyword">if</span> (previousColorElement!=<span class="literal">null</span>) &#123;</div><div class="line">		previousColorElement.className=<span class="string">""</span>;</div><div class="line">	&#125;</div><div class="line">	previousColorElement=imgElement;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">var</span> previousThicknessElement;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeThickness</span>(<span class="params">thickness,imgElement</span>)</span>&#123;</div><div class="line">	</div><div class="line">	context.lineWidth=thickness;                         <span class="comment">//重新设置当前绘图要使用的粗细</span></div><div class="line">	</div><div class="line">	imgElement.className=<span class="string">"Selected"</span>;             <span class="comment">//为刚被单击过的&lt;img&gt;元素应用新样式</span></div><div class="line"></div><div class="line">	<span class="comment">//恢复上一次被单击&lt;img&gt;元素的样式</span></div><div class="line">	<span class="keyword">if</span> (previousThicknessElement!=<span class="literal">null</span>) &#123;</div><div class="line">		previousThicknessElement.className=<span class="string">""</span>;</div><div class="line">	&#125;</div><div class="line">	previousThicknessElement=imgElement;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">var</span> isDrawing=<span class="literal">false</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">startDrawing</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">	</div><div class="line">	isDrawing=<span class="literal">true</span>;                 <span class="comment">// 开始绘图</span></div><div class="line">	</div><div class="line">	context.beginPath();         <span class="comment">//创建新路径</span></div><div class="line"></div><div class="line">	<span class="comment">//把画笔放到鼠标当前所在位置</span></div><div class="line">	context.moveTo(e.pageX - canvas.offsetLeft,e.pageY - canvas.offsetTop);	 <span class="comment">//e 事件对象 pageX,pageY相对于整个页面坐标 offsetLeft offsetTop浏览器左上角到画布左上角距离	</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">draw</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">	<span class="keyword">if</span> (isDrawing==<span class="literal">true</span>) &#123;</div><div class="line"></div><div class="line">        <span class="comment">// 找到鼠标的新位置</span></div><div class="line">	<span class="built_in">var</span> x=e.pageX - canvas.offsetLeft;</div><div class="line">	<span class="built_in">var</span> y=e.pageY-canvas.offsetTop;</div><div class="line"></div><div class="line">	<span class="comment">//画一条到新位置的线</span></div><div class="line">	context.lineTo(x,y);</div><div class="line">	context.stroke();</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">stopDrawing</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	isDrawing=<span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearCanvas</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	context.clearRect(<span class="number">0</span>,<span class="number">0</span>,canvas.width,canvas.height);		<span class="comment">//清空整个画布</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//将画布保存为图像</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">saveCanvas</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// 找到&lt;img&gt;元素</span></div><div class="line">	<span class="built_in">var</span> imageCopy=<span class="built_in">document</span>.getElementById(<span class="string">"savedImageCopy"</span>);</div><div class="line"></div><div class="line">	<span class="comment">//在图像中显示画布数据</span></div><div class="line">	imageCopy.src=canvas.toDataURL();	<span class="comment">//toDataUR("image/jpeg")函数取得当前数据URL，不提供参数默认得到PNG图片</span></div><div class="line">	<span class="comment">/* 数据URL是一个以data:image/png;base64开头的base-64编码的字符串 */</span></div><div class="line"></div><div class="line">	<span class="comment">//显示包含&lt;img&gt;元素的&lt;div&gt;,以便把图像显示出来</span></div><div class="line">	<span class="built_in">var</span> imageContainer=<span class="built_in">document</span>.getElementById(<span class="string">"savedCopyContainer"</span>);</div><div class="line">	imageContainer.style.display=<span class="string">"block"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="style-css"><a href="#style-css" class="headerlink" title="style.css"></a>style.css</h5><figure class="highlight css"><table><tr><td class="code"><pre><div class="line"><span class="selector-tag">body</span>&#123;</div><div class="line">		<span class="attribute">background</span>: white;</div><div class="line">	&#125;</div><div class="line">	<span class="selector-class">.Toolbar</span> &#123;</div><div class="line">	<span class="attribute">float</span>: left;</div><div class="line">	<span class="attribute">font-family</span>: <span class="string">'Trebuchet MS'</span>; </div><div class="line">	<span class="attribute">font-size</span>: <span class="number">14px</span>;</div><div class="line">	<span class="attribute">font-variant</span>: small-caps;</div><div class="line">	<span class="attribute">text-align</span>: center;</div><div class="line">	<span class="attribute">background</span>: <span class="number">#F2F7FE</span>;</div><div class="line">	<span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">15px</span> <span class="number">3px</span> <span class="number">10px</span>;</div><div class="line">	<span class="attribute">margin-bottom</span>: <span class="number">1px</span>;</div><div class="line">	<span class="attribute">margin-right</span>: <span class="number">1px</span>;</div><div class="line">	<span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#7B899B</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="selector-class">.Toolbar</span> <span class="selector-tag">button</span> &#123;</div><div class="line">	<span class="attribute">padding</span>: <span class="number">6px</span>;</div><div class="line">	<span class="attribute">margin</span>: <span class="number">7px</span> <span class="number">2px</span>;</div><div class="line">	<span class="attribute">font-variant</span>: normal;</div><div class="line">	<span class="attribute">font-size</span>: <span class="number">12px</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="selector-class">.CanvasContainer</span> &#123;</div><div class="line">	<span class="attribute">clear</span>: both;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="selector-tag">canvas</span> &#123;</div><div class="line">	<span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#7B899B</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="selector-tag">img</span> &#123;</div><div class="line">	<span class="attribute">padding</span>: <span class="number">2px</span>;</div><div class="line">	<span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#F2F7FE</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="selector-tag">img</span><span class="selector-pseudo">:hover</span> &#123;</div><div class="line">	<span class="attribute">border</span>: <span class="number">2px</span> groove <span class="number">#E4F0FE</span>;</div><div class="line">	<span class="attribute">background</span>: white;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	</div><div class="line">	<span class="selector-tag">img</span><span class="selector-class">.Selected</span> &#123;</div><div class="line">	<span class="attribute">border</span>: <span class="number">2px</span> groove <span class="number">#E4F0FE</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="selector-id">#savedCopyContainer</span> &#123;</div><div class="line">	<span class="attribute">display</span>: none;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="selector-id">#savedCopyContainer</span> <span class="selector-tag">img</span> &#123;</div><div class="line">	<span class="attribute">width</span>: <span class="number">250px</span>;</div><div class="line">	<span class="attribute">height</span>: <span class="number">150px</span>;</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<h3 id="高级Canvas绘图"><a href="#高级Canvas绘图" class="headerlink" title="高级Canvas绘图"></a>高级Canvas绘图</h3><h4 id="绘制图像"><a href="#绘制图像" class="headerlink" title="绘制图像"></a>绘制图像</h4><figure class="highlight actionscript"><table><tr><td class="code"><pre><div class="line"><span class="comment">//创建图片对象</span></div><div class="line"><span class="keyword">var</span> img=<span class="keyword">new</span> Image();</div><div class="line"></div><div class="line"><span class="comment">//context.drawImage()实际上会在img.src后执行</span></div><div class="line"></div><div class="line"><span class="comment">//添加onload事件处理程序</span></div><div class="line"><span class="comment">//告诉浏览器图片加载完成后做什么</span></div><div class="line">img.onload=<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line">context.drawImage(img,<span class="number">10</span>,<span class="number">10</span>,<span class="number">100</span>,<span class="number">100</span>); <span class="comment">//参数分别为img x,y width height</span></div><div class="line">&#125;;</div><div class="line"><span class="comment">//加载图片文件</span></div><div class="line">img.src=<span class="string">" "</span>;</div></pre></td></tr></table></figure>
<h4 id="裁剪、切割、伸缩图片"><a href="#裁剪、切割、伸缩图片" class="headerlink" title="裁剪、切割、伸缩图片"></a>裁剪、切割、伸缩图片</h4><figure class="highlight lsl"><table><tr><td class="code"><pre><div class="line">var img=new Image();</div><div class="line"></div><div class="line">img.onload=function()&#123;</div><div class="line"><span class="comment">//drawImage(img,source_x,source_y,source_width,source_height,x,y,width,height)</span></div><div class="line">context.drawImage(img,<span class="number">0</span>,<span class="number">0</span>,<span class="number">200</span>,<span class="number">100</span>,<span class="number">75</span>,<span class="number">25</span>,<span class="number">200</span>,<span class="number">100</span>);  <span class="comment">//图片200*200，从原始图片的(0,0)位置开始裁剪，得到上半部分，然后把裁剪结果绘制到画布，起点为(75,25)</span></div><div class="line">&#125;;</div><div class="line"><span class="comment">//加载图片文件</span></div><div class="line">img.src=<span class="string">" "</span>;</div></pre></td></tr></table></figure>
<h4 id="绘制视频帧"><a href="#绘制视频帧" class="headerlink" title="绘制视频帧"></a>绘制视频帧</h4><figure class="highlight dart"><table><tr><td class="code"><pre><div class="line"><span class="comment">//捕捉代码运行瞬间正在播放视频中的一帧画面</span></div><div class="line"><span class="keyword">var</span> video=<span class="built_in">document</span>.getElementById(<span class="string">"videoPlayer"</span>);</div><div class="line">context.drawImage(video,<span class="number">0</span>,<span class="number">0</span>,video.clientWidth,video.clientHeight);</div></pre></td></tr></table></figure>
<h4 id="绘制文本"><a href="#绘制文本" class="headerlink" title="绘制文本"></a>绘制文本</h4><figure class="highlight mipsasm"><table><tr><td class="code"><pre><div class="line"><span class="built_in">context</span>.font=<span class="string">"bold 20px Arial"</span><span class="comment">;</span></div><div class="line"><span class="built_in">context</span>.textBaseline=<span class="string">"top"</span><span class="comment">;</span></div><div class="line"><span class="built_in">context</span>.fillStyle=<span class="string">"black"</span><span class="comment">;</span></div><div class="line"></div><div class="line"><span class="built_in">context</span>.fillText(<span class="string">"I'm back!"</span>,<span class="number">50</span>,<span class="number">50</span>)<span class="comment">;</span></div><div class="line"></div><div class="line"><span class="built_in">context</span>.font=<span class="string">"bold 40px Verdana,sans-serif"</span><span class="comment">;</span></div><div class="line"><span class="built_in">context</span>.lineWidth=<span class="number">1</span><span class="comment">;</span></div><div class="line"><span class="built_in">context</span>.fillStyle=<span class="string">"blue"</span><span class="comment">;</span></div><div class="line"><span class="built_in">context</span>.strokeStyle=<span class="string">"red"</span><span class="comment">;</span></div><div class="line"></div><div class="line"><span class="built_in">context</span>.fillText(<span class="string">"I'm back!"</span>,<span class="number">100</span>,<span class="number">100</span>)<span class="comment">;</span></div><div class="line"><span class="built_in">context</span>.strokeText(<span class="string">"I'm back!"</span>,<span class="number">100</span>,<span class="number">100</span>)<span class="comment">;	//绘制轮廓</span></div></pre></td></tr></table></figure>
<h4 id="添加阴影"><a href="#添加阴影" class="headerlink" title="添加阴影"></a>添加阴影</h4><figure class="highlight verilog"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 绘制矩形阴影</span></div><div class="line"><span class="keyword">context</span><span class="variable">.rect</span>(<span class="number">20</span>,<span class="number">20</span>,<span class="number">200</span>,<span class="number">100</span>);</div><div class="line"><span class="keyword">context</span><span class="variable">.fillStyle</span>=<span class="string">"#8ED6FF"</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.shadowColor</span>=<span class="string">"#bbbbbb"</span>;	<span class="comment">// 设置阴影颜色</span></div><div class="line"><span class="keyword">context</span><span class="variable">.shadowBlur</span>=<span class="number">10</span>;		    <span class="comment">// 设置阴影模糊程度,值区间:0-100</span></div><div class="line"><span class="keyword">context</span><span class="variable">.shadowOffsetX</span>=<span class="number">15</span>;	    <span class="comment">// 相对于内容的位置</span></div><div class="line"><span class="keyword">context</span><span class="variable">.shadowOffsetY</span>=<span class="number">15</span>;</div><div class="line"></div><div class="line"><span class="keyword">context</span><span class="variable">.fill</span>();</div><div class="line"></div><div class="line"><span class="keyword">context</span><span class="variable">.font</span>=<span class="string">"bold 20px Arial"</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.textBaseline</span>=<span class="string">"top"</span>;</div><div class="line"></div><div class="line"><span class="comment">//绘制三行文本的阴影</span></div><div class="line"><span class="keyword">context</span><span class="variable">.fillStyle</span>=<span class="string">"steelblue"</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.shadowBlur</span>=<span class="number">3</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.shadowOffsetX</span>=<span class="number">2</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.shadowOffsetY</span>=<span class="number">2</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.fillText</span>(<span class="string">"I'm Back!"</span>,<span class="number">10</span>,<span class="number">175</span>);</div><div class="line"></div><div class="line"><span class="keyword">context</span><span class="variable">.shadowBlur</span>=<span class="number">5</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.shadowOffsetX</span>=<span class="number">20</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.shadowOffsetY</span>=<span class="number">20</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.fillStyle</span>=<span class="string">"green"</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.fillText</span>(<span class="string">"I'm Back!"</span>,<span class="number">10</span>,<span class="number">225</span>);</div><div class="line"></div><div class="line"><span class="keyword">context</span><span class="variable">.shadowBlur</span>=<span class="number">15</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.shadowOffsetX</span>=<span class="number">0</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.shadowOffsetY</span>=<span class="number">0</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.shadowColor</span>=<span class="string">"black"</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.strokeStyle</span>=<span class="string">"white"</span>;</div><div class="line"><span class="keyword">context</span><span class="variable">.strokeText</span>(<span class="string">"I'm Back!"</span>,<span class="number">10</span>,<span class="number">300</span>);</div></pre></td></tr></table></figure>
<h4 id="填充图案"><a href="#填充图案" class="headerlink" title="填充图案"></a>填充图案</h4><figure class="highlight xml"><table><tr><td class="code"><pre><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">	<span class="built_in">window</span>.onload=<span class="function"><span class="keyword">function</span>  (<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="keyword">var</span> canvas  = <span class="built_in">document</span>.getElementById(<span class="string">"drawingCanvas"</span>);</div><div class="line">		<span class="keyword">var</span> context = canvas.getContext(<span class="string">"2d"</span>);</div><div class="line">		<span class="keyword">var</span> img     =<span class="built_in">document</span>.getElementById(<span class="string">"brickTile"</span>);</div><div class="line"></div><div class="line">		<span class="keyword">var</span> pattern =context.createPattern(img,<span class="string">"repeat"</span>); <span class="comment">//创建图案对象 repeat-x(水平) repeat-y(垂直) repeat(重复)</span></div><div class="line"></div><div class="line">		context.fillStyle=pattern;</div><div class="line">		context.rect(<span class="number">0</span>,<span class="number">0</span>,canvas.width,canvas.height);</div><div class="line">		context.fill();</div><div class="line">	&#125;;</div><div class="line">	<span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"drawingCanvas"</span> <span class="attr">width</span>=<span class="string">"500"</span> <span class="attr">height</span>=<span class="string">"300"</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"brick_tile.gif"</span> <span class="attr">id</span>=<span class="string">"brickTile"</span> <span class="attr">alt</span>=<span class="string">"填充图案"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="填充渐变"><a href="#填充渐变" class="headerlink" title="填充渐变"></a>填充渐变</h4><blockquote>
<p>可以把渐变想象成位于画布下方彩色图样，创建渐变时，是在创建这个彩色但却隐藏的图样。而当填充图案时，会在画布上按图形形状抠一个洞，从而让下面那部分图样显现出来。</p>
</blockquote>
<figure class="highlight lsl"><table><tr><td class="code"><pre><div class="line">window.onload = function() &#123;</div><div class="line">  canvas = document.getElementById(<span class="string">"drawingCanvas"</span>);</div><div class="line">  context = canvas.getContext(<span class="string">"2d"</span>);</div><div class="line"></div><div class="line">  <span class="comment">//创建一个从(10,0)到(100,0)的渐变</span></div><div class="line">  var gradient = context.createLinearGradient(<span class="number">10</span>, <span class="number">0</span>, <span class="number">100</span>, <span class="number">0</span>); <span class="comment">//创建线性渐变createLinearGradient</span></div><div class="line">  gradient.addColorStop(<span class="number">0</span>, <span class="string">"magenta"</span>);<span class="comment">//设置渐变颜色 偏移值(范围0~1)决定颜色在渐变中的位置，0表示渐变起点 1终点</span></div><div class="line">  gradient.addColorStop(<span class="number">1</span>, <span class="string">"yellow"</span>);</div><div class="line"></div><div class="line">  <span class="comment">//调用绘制心形函数</span></div><div class="line">  drawHeart(<span class="number">60</span>, <span class="number">50</span>);</div><div class="line"></div><div class="line">  context.fillStyle = gradient;</div><div class="line">  context.fill();</div><div class="line">  context.stroke();</div><div class="line"></div><div class="line">  <span class="comment">//创建放射性渐变createRadialGradient</span></div><div class="line">  gradient = context.createRadialGradient(<span class="number">180</span>, <span class="number">100</span>, <span class="number">10</span>, <span class="number">180</span>, <span class="number">100</span>, <span class="number">50</span>); <span class="comment">//(180,100) 小圆圆心 10 小圆半径 (180,100)大圆半径 50 大圆半径</span></div><div class="line">  gradient.addColorStop(<span class="number">0</span>, <span class="string">"magenta"</span>);</div><div class="line">  gradient.addColorStop(<span class="number">1</span>, <span class="string">"yellow"</span>); </div><div class="line"></div><div class="line">  drawHeart(<span class="number">180</span>, <span class="number">80</span>);</div><div class="line">  context.fillStyle = gradient;</div><div class="line">  context.fill();</div><div class="line">  context.stroke();</div><div class="line"></div><div class="line">  gradient = context.createLinearGradient(<span class="number">10</span>, <span class="number">0</span>, <span class="number">100</span>, <span class="number">0</span>);</div><div class="line">  gradient.addColorStop(<span class="string">"0"</span>,<span class="string">"magenta"</span>);</div><div class="line">  gradient.addColorStop(<span class="string">".25"</span>,<span class="string">"blue"</span>);</div><div class="line">  gradient.addColorStop(<span class="string">".50"</span>,<span class="string">"green"</span>);</div><div class="line">  gradient.addColorStop(<span class="string">".75"</span>,<span class="string">"yellow"</span>);</div><div class="line">  gradient.addColorStop(<span class="string">"1.0"</span>,<span class="string">"red"</span>);</div><div class="line"></div><div class="line">  drawHeart(<span class="number">60</span>, <span class="number">200</span>);</div><div class="line">  context.fillStyle = gradient;</div><div class="line">  context.fill();</div><div class="line">  context.stroke();</div><div class="line"></div><div class="line">  gradient = context.createRadialGradient(<span class="number">180</span>, <span class="number">250</span>, <span class="number">10</span>, <span class="number">180</span>, <span class="number">250</span>, <span class="number">50</span>);</div><div class="line">  gradient.addColorStop(<span class="string">"0"</span>,<span class="string">"magenta"</span>);</div><div class="line">  gradient.addColorStop(<span class="string">".25"</span>,<span class="string">"blue"</span>);</div><div class="line">  gradient.addColorStop(<span class="string">".50"</span>,<span class="string">"green"</span>);</div><div class="line">  gradient.addColorStop(<span class="string">".75"</span>,<span class="string">"yellow"</span>);</div><div class="line">  gradient.addColorStop(<span class="string">"1.0"</span>,<span class="string">"red"</span>);</div><div class="line"></div><div class="line">  drawHeart(<span class="number">180</span>, <span class="number">230</span>);</div><div class="line">  context.fillStyle = gradient;</div><div class="line">  context.fill();</div><div class="line">  context.stroke();  </div><div class="line">&#125;;</div><div class="line"></div><div class="line"></div><div class="line">function drawHeart(x, y) &#123;</div><div class="line">  context.beginPath();</div><div class="line">  context.moveTo(x, y);</div><div class="line">  context.bezierCurveTo(x, y - <span class="number">40</span>, x - <span class="number">45</span>, y - <span class="number">40</span>, x - <span class="number">48</span>, y);</div><div class="line">  context.bezierCurveTo(x - <span class="number">45</span>, y + <span class="number">30</span>, x, y + <span class="number">40</span>, x, y + <span class="number">80</span>);</div><div class="line">  context.bezierCurveTo(x, y + <span class="number">90</span>, x + <span class="number">45</span>, y + <span class="number">40</span>, x + <span class="number">45</span>, y);</div><div class="line">  context.bezierCurveTo(x + <span class="number">45</span>, y - <span class="number">30</span>, x, y - <span class="number">30</span>, x, y);</div><div class="line">  context.closePath();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="绘制图解"><a href="#绘制图解" class="headerlink" title="绘制图解"></a>绘制图解</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line">	<span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="keyword">var</span> extraversion = <span class="built_in">Number</span>(getQueryVariable(<span class="string">"e"</span>));</div><div class="line">		<span class="keyword">var</span> accommodation = <span class="built_in">Number</span>(getQueryVariable(<span class="string">"a"</span>));</div><div class="line">		<span class="keyword">var</span> conscientiousness = <span class="built_in">Number</span>(getQueryVariable(<span class="string">"c"</span>));</div><div class="line">		<span class="keyword">var</span> neuroticism = <span class="built_in">Number</span>(getQueryVariable(<span class="string">"n"</span>));</div><div class="line">		<span class="keyword">var</span> openness = <span class="built_in">Number</span>(getQueryVariable(<span class="string">"o"</span>));</div><div class="line"></div><div class="line">  <span class="comment">// Show the score numbers.</span></div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">"headingE"</span>).innerHTML += extraversion;</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">"headingA"</span>).innerHTML += accommodation;</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">"headingC"</span>).innerHTML += conscientiousness;</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">"headingN"</span>).innerHTML += neuroticism;</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">"headingO"</span>).innerHTML += openness;</div><div class="line"></div><div class="line">  <span class="comment">// Draw the scores.</span></div><div class="line">  plotScore(<span class="built_in">document</span>.getElementById(<span class="string">"canvasE"</span>), extraversion, <span class="string">"Extraversion"</span>);</div><div class="line">  plotScore(<span class="built_in">document</span>.getElementById(<span class="string">"canvasA"</span>), accommodation, <span class="string">"Accommodation"</span>);</div><div class="line">  plotScore(<span class="built_in">document</span>.getElementById(<span class="string">"canvasC"</span>), conscientiousness, <span class="string">"Conscientiousness"</span>);</div><div class="line">  plotScore(<span class="built_in">document</span>.getElementById(<span class="string">"canvasN"</span>), neuroticism, <span class="string">"Neuroticism"</span>);</div><div class="line">  plotScore(<span class="built_in">document</span>.getElementById(<span class="string">"canvasO"</span>), openness, <span class="string">"Openness"</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">getQueryVariable</span>(<span class="params">variable</span>) </span>&#123;</div><div class="line">		<span class="keyword">var</span> query = <span class="built_in">window</span>.location.search.substring(<span class="number">1</span>); 	<span class="comment">//获取?后面的URL</span></div><div class="line">		<span class="keyword">var</span> vars = query.split(<span class="string">"&amp;"</span>);						<span class="comment">//以&amp;为分隔符切割字符串并保存为数组</span></div><div class="line">		<span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;vars.length;i++) &#123;</div><div class="line">			<span class="keyword">var</span> pair = vars[i].split(<span class="string">"="</span>);</div><div class="line">			<span class="keyword">if</span> (pair[<span class="number">0</span>] == variable) &#123;</div><div class="line">				<span class="keyword">return</span> pair[<span class="number">1</span>];</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">plotScore</span>(<span class="params">canvas,score,title</span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> context=canvas.getContext(<span class="string">"2d"</span>);</div><div class="line"></div><div class="line">		<span class="comment">//在图示的两端绘制箭头</span></div><div class="line">		<span class="keyword">var</span> img=<span class="built_in">document</span>.getElementById(<span class="string">"arrow_left"</span>);</div><div class="line">		context.drawImage(img,<span class="number">12</span>,<span class="number">10</span>);</div><div class="line">		img=<span class="built_in">document</span>.getElementById(<span class="string">"arrow_right"</span>);</div><div class="line">		context.drawImage(img,<span class="number">498</span>,<span class="number">10</span>);</div><div class="line"></div><div class="line">		<span class="comment">//绘制箭头之间的刻度线</span></div><div class="line">		context.moveTo(<span class="number">39</span>,<span class="number">25</span>);</div><div class="line">		context.lineTo(<span class="number">503</span>,<span class="number">25</span>);</div><div class="line">		context.lineWidth=<span class="number">10</span>;</div><div class="line">		context.strokeStyle=<span class="string">"rgb(174,215,244)"</span>;</div><div class="line">		context.stroke();</div><div class="line"></div><div class="line">		<span class="comment">//把数值写在刻度位置上</span></div><div class="line">		context.fillStyle=context.strokeStyle;</div><div class="line">		context.font=<span class="string">"italic bold 18px Arial"</span>;</div><div class="line">		context.textBaseline=<span class="string">"top"</span>;</div><div class="line"></div><div class="line">		context.fillText(<span class="string">"-20"</span>,<span class="number">35</span>,<span class="number">50</span>);</div><div class="line">		context.fillText(<span class="string">"0"</span>,<span class="number">255</span>,<span class="number">50</span>);</div><div class="line">		context.fillText(<span class="string">"20"</span>,<span class="number">475</span>,<span class="number">50</span>);</div><div class="line"></div><div class="line">		<span class="comment">//绘制星星,显示分数在图示上的位置</span></div><div class="line">		img.document.getElementById(<span class="string">"star"</span>);</div><div class="line">		context.drawImage(img,(score+<span class="number">20</span>)/<span class="number">40</span>*<span class="number">440</span>+<span class="number">35</span><span class="number">-17</span>,<span class="number">0</span>);</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<h3 id="canvas图形交互"><a href="#canvas图形交互" class="headerlink" title="canvas图形交互"></a>canvas图形交互</h3><h4 id="InteractiveCircles-html"><a href="#InteractiveCircles-html" class="headerlink" title="InteractiveCircles.html"></a>InteractiveCircles.html</h4><figure class="highlight xml"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"canvas"</span> <span class="attr">width</span>=<span class="string">"400"</span> <span class="attr">height</span>=<span class="string">"300"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"addRandomCircle()"</span>&gt;</span>Add Circle<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"clearCanvas()"</span>&gt;</span>Clear Canvas<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="InteractiveCircles-js"><a href="#InteractiveCircles-js" class="headerlink" title="InteractiveCircles.js"></a>InteractiveCircles.js</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="comment">// This function stores the details for a single circle.</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Circle</span>(<span class="params">x, y, radius, color</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.x = x;</div><div class="line">  <span class="keyword">this</span>.y = y;</div><div class="line">  <span class="keyword">this</span>.radius = radius;</div><div class="line">  <span class="keyword">this</span>.color = color;</div><div class="line">  <span class="keyword">this</span>.isSelected = <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// This array hold all the circles on the canvas.</span></div><div class="line"><span class="keyword">var</span> circles = [];</div><div class="line"></div><div class="line"><span class="keyword">var</span> canvas;</div><div class="line"><span class="keyword">var</span> context;</div><div class="line"></div><div class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  canvas = <span class="built_in">document</span>.getElementById(<span class="string">"canvas"</span>);</div><div class="line">  context = canvas.getContext(<span class="string">"2d"</span>);</div><div class="line"></div><div class="line">    canvas.onmousedown = canvasClick;</div><div class="line">    canvas.onmouseup   = stopDragging;</div><div class="line">    canvas.onmouseout  = stopDragging;</div><div class="line">    canvas.onmousemove = dragCircle;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addRandomCircle</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// Give the circle a random size and position.</span></div><div class="line">  <span class="keyword">var</span> radius = randomFromTo(<span class="number">10</span>, <span class="number">60</span>);</div><div class="line">  <span class="keyword">var</span> x = randomFromTo(<span class="number">0</span>, canvas.width);</div><div class="line">  <span class="keyword">var</span> y = randomFromTo(<span class="number">0</span>, canvas.height);</div><div class="line"></div><div class="line">  <span class="comment">// Give the circle a random color.</span></div><div class="line">  <span class="keyword">var</span> colors = [<span class="string">"green"</span>, <span class="string">"blue"</span>, <span class="string">"red"</span>, <span class="string">"yellow"</span>, <span class="string">"magenta"</span>, <span class="string">"orange"</span>, <span class="string">"brown"</span>, <span class="string">"purple"</span>, <span class="string">"pink"</span>];</div><div class="line">  <span class="keyword">var</span> color = colors[randomFromTo(<span class="number">0</span>, <span class="number">8</span>)];</div><div class="line"></div><div class="line">  <span class="comment">// Create the new circle.</span></div><div class="line">  <span class="keyword">var</span> circle = <span class="keyword">new</span> Circle(x, y, radius, color);</div><div class="line"></div><div class="line">  <span class="comment">// Store it in the array.</span></div><div class="line">  circles.push(circle);</div><div class="line"></div><div class="line">  <span class="comment">// 重新绘制画布</span></div><div class="line">  drawCircles();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearCanvas</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// Remove all the circles.</span></div><div class="line">  circles = [];</div><div class="line"></div><div class="line">  <span class="comment">// Update the display.</span></div><div class="line">  drawCircles();</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawCircles</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// Clear the canvas.</span></div><div class="line">  context.clearRect(<span class="number">0</span>, <span class="number">0</span>, canvas.width, canvas.height);</div><div class="line"></div><div class="line">  <span class="comment">// Go through all the circles.</span></div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;circles.length; i++) &#123;</div><div class="line">    <span class="keyword">var</span> circle = circles[i];</div><div class="line"></div><div class="line">    <span class="comment">// Draw the circle.</span></div><div class="line">    context.globalAlpha = <span class="number">0.85</span>;</div><div class="line">    context.beginPath();</div><div class="line">    context.arc(circle.x, circle.y, circle.radius, <span class="number">0</span>, <span class="built_in">Math</span>.PI*<span class="number">2</span>);</div><div class="line">    context.fillStyle = circle.color;</div><div class="line">    context.strokeStyle = <span class="string">"black"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (circle.isSelected) &#123;</div><div class="line">      context.lineWidth = <span class="number">5</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">      context.lineWidth = <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    context.fill();</div><div class="line">    context.stroke(); </div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> previousSelectedCircle;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">canvasClick</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">  <span class="comment">// Get the canvas click coordinates.</span></div><div class="line">  <span class="keyword">var</span> clickX = e.pageX - canvas.offsetLeft;</div><div class="line">  <span class="keyword">var</span> clickY = e.pageY - canvas.offsetTop;</div><div class="line"></div><div class="line">  <span class="comment">// 反向遍历所有的圆，因为如果两个圆发生叠加，只能单机上面一层也就是后面添加的圆</span></div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i=circles.length<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) &#123;</div><div class="line">    <span class="keyword">var</span> circle = circles[i];</div><div class="line">    <span class="comment">//pow() n次方函数  sqrt() 开根号</span></div><div class="line">    <span class="keyword">var</span> distanceFromCenter = <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(circle.x - clickX, <span class="number">2</span>) + <span class="built_in">Math</span>.pow(circle.y - clickY, <span class="number">2</span>)); </div><div class="line">    <span class="keyword">if</span> (distanceFromCenter &lt;= circle.radius) &#123;</div><div class="line">      <span class="keyword">if</span> (previousSelectedCircle != <span class="literal">null</span>) previousSelectedCircle.isSelected = <span class="literal">false</span>;</div><div class="line">      previousSelectedCircle = circle;</div><div class="line"></div><div class="line">      circle.isSelected = <span class="literal">true</span>;</div><div class="line">      isDragging = <span class="literal">true</span>;</div><div class="line">      drawCircles();</div><div class="line">      <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> isDragging = <span class="literal">false</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">stopDragging</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  isDragging = <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">dragCircle</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">  <span class="comment">// Is a circle being dragged?</span></div><div class="line">  <span class="keyword">if</span> (isDragging == <span class="literal">true</span>) &#123;</div><div class="line">    <span class="comment">// Make sure there really is a circle object (just in case).</span></div><div class="line">    <span class="keyword">if</span> (previousSelectedCircle != <span class="literal">null</span>) &#123;</div><div class="line">      <span class="comment">// Find the new position of the mouse.</span></div><div class="line">      <span class="keyword">var</span> x = e.pageX - canvas.offsetLeft;</div><div class="line">      <span class="keyword">var</span> y = e.pageY - canvas.offsetTop;</div><div class="line"></div><div class="line">      <span class="comment">// Move the circle to that position.</span></div><div class="line">      previousSelectedCircle.x = x;</div><div class="line">      previousSelectedCircle.y = y;</div><div class="line"></div><div class="line">      <span class="comment">// Update the canvas.</span></div><div class="line">      drawCircles();</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">randomFromTo</span>(<span class="params">from, to</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * (to - <span class="keyword">from</span> + <span class="number">1</span>) + <span class="keyword">from</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="canvas动画"><a href="#canvas动画" class="headerlink" title="canvas动画"></a>canvas动画</h2><h4 id="基本动画-方形下落"><a href="#基本动画-方形下落" class="headerlink" title="基本动画(方形下落)"></a>基本动画(方形下落)</h4><figure class="highlight verilog"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> canvas;</div><div class="line"><span class="keyword">var</span> <span class="keyword">context</span>;</div><div class="line"></div><div class="line">window<span class="variable">.onload</span> = <span class="keyword">function</span>() &#123;</div><div class="line">canvas = document<span class="variable">.getElementById</span>(<span class="string">"canvas"</span>);</div><div class="line"><span class="keyword">context</span> = canvas<span class="variable">.getContext</span>(<span class="string">"2d"</span>);</div><div class="line"></div><div class="line"><span class="comment">// 每0.02秒绘制一次画布</span></div><div class="line">setTimeout(<span class="string">"drawFrame()"</span>,<span class="number">20</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//设置方形初始位置</span></div><div class="line"><span class="keyword">var</span> squarePosition_y=<span class="number">0</span>;</div><div class="line"><span class="keyword">var</span> squarePosition_x=<span class="number">10</span>;</div><div class="line"></div><div class="line"><span class="keyword">function</span> drawFrame () &#123;</div><div class="line">	<span class="keyword">context</span><span class="variable">.clearRect</span>(<span class="number">0</span>,<span class="number">0</span>,canvas<span class="variable">.width</span>,canvas<span class="variable">.height</span>);</div><div class="line"></div><div class="line">	<span class="comment">// 调用beginPath()确保不会接上次绘制的图像绘制</span></div><div class="line">	<span class="keyword">context</span><span class="variable">.beginPath</span>();</div><div class="line"></div><div class="line">	<span class="comment">//在当前位置绘制10*10的方形</span></div><div class="line">	<span class="keyword">context</span><span class="variable">.rect</span>(squarePosition_x,squarePosition_y,<span class="number">10</span>,<span class="number">10</span>);</div><div class="line">	<span class="keyword">context</span><span class="variable">.lineStyle</span>=<span class="string">"black"</span>;</div><div class="line">	<span class="keyword">context</span><span class="variable">.lineWidth</span>=<span class="number">1</span>;</div><div class="line">	<span class="keyword">context</span><span class="variable">.stroke</span>();</div><div class="line"></div><div class="line">	<span class="comment">// 向下移动1像素</span></div><div class="line">	squarePosition_y +=<span class="number">1</span>;</div><div class="line"></div><div class="line">	setTimeout(<span class="string">"drawFrame()"</span>,<span class="number">20</span>);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="多物体动画-模拟小球自由下落"><a href="#多物体动画-模拟小球自由下落" class="headerlink" title="多物体动画(模拟小球自由下落)"></a>多物体动画(模拟小球自由下落)</h4><figure class="highlight xml"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Animation<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></div><div class="line"><span class="selector-tag">body</span> &#123;</div><div class="line">  <span class="attribute">font-family</span>: Verdana;</div><div class="line">  <span class="attribute">font-size</span>: small;</div><div class="line">&#125;</div><div class="line"><span class="selector-tag">canvas</span> &#123;</div><div class="line">  <span class="attribute">cursor</span>: pointer;</div><div class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid black;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-tag">div</span> &#123;</div><div class="line">  <span class="attribute">margin</span>: <span class="number">15px</span> <span class="number">0px</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-tag">button</span> &#123;</div><div class="line">  <span class="attribute">padding</span>: <span class="number">4px</span> <span class="number">10px</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=number]</span> &#123;</div><div class="line">  <span class="attribute">width</span>: <span class="number">50px</span>;</div><div class="line">  <span class="attribute">margin-right</span>: <span class="number">15px</span>;</div><div class="line">&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"></div><div class="line"><span class="comment">// These are the details that represent an individual ball.</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Ball</span>(<span class="params">x, y, dx, dy, radius</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.x = x;</div><div class="line">  <span class="keyword">this</span>.y = y;</div><div class="line">  <span class="keyword">this</span>.dx = dx;</div><div class="line">  <span class="keyword">this</span>.dy = dy;</div><div class="line">  <span class="keyword">this</span>.radius = radius;</div><div class="line">  <span class="keyword">this</span>.strokeColor = <span class="string">"black"</span>;</div><div class="line">  <span class="keyword">this</span>.fillColor = <span class="string">"red"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// This is an array that will hold all the balls on the canvas</span></div><div class="line"><span class="keyword">var</span> balls = [];</div><div class="line"></div><div class="line"><span class="keyword">var</span> canvas;</div><div class="line"><span class="keyword">var</span> context;</div><div class="line"></div><div class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  canvas = <span class="built_in">document</span>.getElementById(<span class="string">"canvas"</span>);</div><div class="line">  context = canvas.getContext(<span class="string">"2d"</span>);</div><div class="line"></div><div class="line">  canvas.onmousedown = canvasClick;</div><div class="line"></div><div class="line">  <span class="comment">// Redraw every 20 milliseconds.</span></div><div class="line">  setTimeout(drawFrame, <span class="number">20</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addBall</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// Get the requested size.</span></div><div class="line">  <span class="keyword">var</span> radius = <span class="built_in">parseFloat</span>(<span class="built_in">document</span>.getElementById(<span class="string">"ballSize"</span>).value);</div><div class="line"></div><div class="line">  <span class="comment">// Create the new ball.</span></div><div class="line">  <span class="keyword">var</span> ball = <span class="keyword">new</span> Ball(<span class="number">50</span>,<span class="number">50</span>,<span class="number">1</span>,<span class="number">1</span>,radius);</div><div class="line"></div><div class="line">  <span class="comment">// Store it in the ball array.</span></div><div class="line">  balls.push(ball);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearBalls</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// Remove all the balls.</span></div><div class="line">  balls = [];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawFrame</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// Clear the canvas.</span></div><div class="line">  context.clearRect(<span class="number">0</span>, <span class="number">0</span>, canvas.width, canvas.height);</div><div class="line"></div><div class="line">  <span class="comment">// Note that you need to call beginPath() to make sure you don't redraw part of what</span></div><div class="line">  <span class="comment">// you were drawing before.</span></div><div class="line">  context.beginPath();</div><div class="line"></div><div class="line">  <span class="comment">// Go through all the balls.</span></div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;balls.length; i++) &#123;</div><div class="line">    <span class="comment">// Move each ball to its new position.</span></div><div class="line">    <span class="keyword">var</span> ball = balls[i];</div><div class="line">    ball.x += ball.dx;</div><div class="line">    ball.y += ball.dy;</div><div class="line"></div><div class="line">    <span class="comment">// Add in a "gravity" effect that makes the ball fall faster.</span></div><div class="line">    <span class="keyword">if</span> ((ball.y) &lt; canvas.height) ball.dy += <span class="number">0.22</span>;</div><div class="line"></div><div class="line">    <span class="comment">// Add in a "friction" effect that slows down the ball's side-to-side motion.</span></div><div class="line">    ball.dx = ball.dx * <span class="number">0.998</span>;</div><div class="line"></div><div class="line">    <span class="comment">// If the ball has hit the side, bounce it.</span></div><div class="line">    <span class="keyword">if</span> ((ball.x + ball.radius &gt; canvas.width) || (ball.x - ball.radius &lt; <span class="number">0</span>)) &#123;</div><div class="line">      ball.dx = -ball.dx;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// If the ball has hit the bottom, bounce it, but slow it down slightly.</span></div><div class="line">    <span class="keyword">if</span> ((ball.y + ball.radius &gt; canvas.height) || (ball.y - ball.radius &lt; <span class="number">0</span>)) &#123; </div><div class="line">      ball.dy = -ball.dy*<span class="number">0.96</span>; </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// Check if the user wants lines.</span></div><div class="line">    <span class="keyword">if</span> (!<span class="built_in">document</span>.getElementById(<span class="string">"connectedBalls"</span>).checked) &#123;</div><div class="line">      context.beginPath();</div><div class="line">      context.fillStyle = ball.fillColor;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">      context.fillStyle = <span class="string">"white"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// Draw the ball.</span></div><div class="line">    context.arc(ball.x, ball.y, ball.radius, <span class="number">0</span>, <span class="built_in">Math</span>.PI*<span class="number">2</span>);</div><div class="line">    context.lineWidth = <span class="number">1</span>;</div><div class="line">    context.fill();</div><div class="line">    context.stroke(); </div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// Draw the next frame in 20 milliseconds.</span></div><div class="line">  setTimeout(drawFrame, <span class="number">20</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">canvasClick</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">  <span class="comment">// Get the canvas click coordinates.</span></div><div class="line">  <span class="keyword">var</span> clickX = e.pageX - canvas.offsetLeft;</div><div class="line">  <span class="keyword">var</span> clickY = e.pageY - canvas.offsetTop;</div><div class="line"></div><div class="line"></div><div class="line">  <span class="comment">// Look for the clicked ball.</span></div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> balls)</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">var</span> ball = balls[i];</div><div class="line">    <span class="keyword">if</span> ((clickX &gt; (ball.x-ball.radius)) &amp;&amp; (clickX &lt; (ball.x+ball.radius)))</div><div class="line">    &#123;</div><div class="line">      <span class="keyword">if</span> ((clickY &gt; (ball.y-ball.radius)) &amp;&amp; (clickY &lt; (ball.y+ball.radius)))</div><div class="line">      &#123;</div><div class="line">        <span class="comment">// Change the clicked ball's speed.</span></div><div class="line">        ball.dx -= <span class="number">2</span>;</div><div class="line">        ball.dy -= <span class="number">3</span>;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line">  </div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"canvas"</span> <span class="attr">width</span>=<span class="string">"400"</span> <span class="attr">height</span>=<span class="string">"300"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"addBall()"</span>&gt;</span>Add Ball<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"clearBalls()"</span>&gt;</span>Clear Canvas<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">    Ball Size:<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"ballSize"</span> <span class="attr">type</span>=<span class="string">"number"</span> <span class="attr">min</span>=<span class="string">"0"</span> <span class="attr">max</span>=<span class="string">"50"</span> <span class="attr">value</span>=<span class="string">"15"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"connectedBalls"</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span>Connect Balls<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">    </div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://vino24.cn/2015/03/18/canvas-first/" data-id="cixa9pomj002wearnvasqzc9m" class="article-share-link">分享到</a><div class="tags"><a href="/tags/JavaScript-API/">JavaScript API</a></div><div class="post-nav"><a href="/2015/03/22/http-cache/" class="pre">浏览器缓存(HTTP Cache)控制简介及配置策略</a><a href="/2015/03/15/audio-video-canvas-fixed/" class="next">Audio&amp;&amp;Vedio兼容方案</a></div><div data-thread-key="2015/03/18/canvas-first/" data-title="Canvas入门" data-url="http://vino24.cn/2015/03/18/canvas-first/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2015/03/18/canvas-first/" data-title="Canvas入门" data-url="http://vino24.cn/2015/03/18/canvas-first/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CSS/">CSS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTTP/">HTTP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/IE/">IE</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript-API/">JavaScript API</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript-Framework/">JavaScript Framework</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mobile-Develop/">Mobile Develop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Performance-Optimize/">Performance Optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Requirements-Daily/">Requirements&&Daily</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/devTools-Configuration/">devTools&&Configuration</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/切图/">切图</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/总结/">总结</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Ajax/" style="font-size: 15px;">Ajax</a> <a href="/tags/CSS-Layout/" style="font-size: 15px;">CSS Layout</a> <a href="/tags/CSS-Core/" style="font-size: 15px;">CSS Core</a> <a href="/tags/CSS-Collection/" style="font-size: 15px;">CSS Collection</a> <a href="/tags/DOM/" style="font-size: 15px;">DOM</a> <a href="/tags/CSS-core/" style="font-size: 15px;">CSS core</a> <a href="/tags/ES6/" style="font-size: 15px;">ES6</a> <a href="/tags/JavaScript-Core/" style="font-size: 15px;">JavaScript Core</a> <a href="/tags/bind/" style="font-size: 15px;">bind</a> <a href="/tags/PS/" style="font-size: 15px;">PS</a> <a href="/tags/性能优化/" style="font-size: 15px;">性能优化</a> <a href="/tags/avalon-js/" style="font-size: 15px;">avalon.js</a> <a href="/tags/JavaScript-API/" style="font-size: 15px;">JavaScript API</a> <a href="/tags/Flex/" style="font-size: 15px;">Flex</a> <a href="/tags/内存泄漏/" style="font-size: 15px;">内存泄漏</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/Mac/" style="font-size: 15px;">Mac</a> <a href="/tags/Netease-Weekly/" style="font-size: 15px;">Netease Weekly</a> <a href="/tags/react-js/" style="font-size: 15px;">react.js</a> <a href="/tags/React/" style="font-size: 15px;">React</a> <a href="/tags/this/" style="font-size: 15px;">this</a> <a href="/tags/three-js/" style="font-size: 15px;">three.js</a> <a href="/tags/Vue/" style="font-size: 15px;">Vue</a> <a href="/tags/Tips/" style="font-size: 15px;">Tips</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/12/08/es6-spread-rest/">ES6 spread和rest operator</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/08/react-form/">react中的表单</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/06/github-tip/">github实用技巧</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/02/react-first/">react.js入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/28/avalon-first-md/">avalon.js入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/22/chrome-dev-tools-console/">Chrome Dev Tools使用技巧总结(一) Console</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/02/fetch-api/">Fetch API</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/01/hexo-basic/">hexo常用配置一览</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/31/wechat-music-serach-module-update/">微信点歌模块代码更新及hexo音乐插件</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/27/three.js-first/">three.js入门</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> 最近评论</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://bgm.iminyao.com/" title="背景音乐" target="_blank">背景音乐</a><ul></ul><a href="http://weibo.com/jzwmxz" title="民谣之家" target="_blank">民谣之家</a><ul></ul><a href="http://www.zhihu.com/people/iminyao" title="逢十借一" target="_blank">逢十借一</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">逢十借一.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"></a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'vino24'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>